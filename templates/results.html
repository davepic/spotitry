{% extends "base.html" %}
{% block title %} Search Results {% endblock %}



{% block body %}

	<h1>Search</h1>
	{{pagination.info}}
	{{pagination.links}}
	

	{% if failed %}

		<p style="color:red;">No events matched your search. Please try again</p>

	{% endif %}
	<form action="/search" method="POST">

	{% if user_search %}
		<input type="text" style="width:35%; margin:0 auto; margin-bottom:10px;display:inline;" placeholder="{{user_search}}" name="user_search"/>
	{%	else %}
		<input type="text" style="width:35%; margin:0 auto; margin-bottom:10px;display:inline;" placeholder="Search events (optional)" name="user_search"/>

	{%	endif %}
	

	


<select name="category_search" style="width:8%; margin:0 auto; margin-bottom:10px;">

	<option value="">Category</option>

	{% if category=="concert" %}
	
		<option value="concert" selected>Concerts</option>
	{% else %}

		<option value="concert">Concerts</option>

	{% endif %}

	{% if category=="sports" %}
	
		<option value="sports" selected>Sports</option>
	{% else %}

		<option value="sports">Sports</option>

	{% endif %}

	{% if category=="comedy" %}
	
		<option value="comedy" selected>Comedy</option>
	{% else %}

		<option value="comedy">Comedy</option>

	{% endif %}

	{% if category=="theater" %}
	
		<option value="theater" selected>Theater</option>
	{% else %}

		<option value="theater">Theater</option>

	{% endif %}

	{% if category==""%}

		<option value="" selected>All</option>
	{% else %}
		<option value="">All</option>
	{% endif %}
	
</select>	

<select name="state_search" style="width:10%; margin:0 auto; margin-bottom:10px;" required>

	<option value="" selected>Select State</option>
	<option value="AL">Alabama</option>
	<option value="AK">Alaska</option>
	<option value="AZ">Arizona</option>
	<option value="AR">Arkansas</option>
	<option value="CA">California</option>
	<option value="CO">Colorado</option>
	<option value="CT">Connecticut</option>
	<option value="DE">Delaware</option>
	<option value="DC">District Of Columbia</option>
	<option value="FL">Florida</option>
	<option value="GA">Georgia</option>
	<option value="HI">Hawaii</option>
	<option value="ID">Idaho</option>
	<option value="IL">Illinois</option>
	<option value="IN">Indiana</option>
	<option value="IA">Iowa</option>
	<option value="KS">Kansas</option>
	<option value="KY">Kentucky</option>
	<option value="LA">Louisiana</option>
	<option value="ME">Maine</option>
	<option value="MD">Maryland</option>
	<option value="MA">Massachusetts</option>
	<option value="MI">Michigan</option>
	<option value="MN">Minnesota</option>
	<option value="MS">Mississippi</option>
	<option value="MO">Missouri</option>
	<option value="MT">Montana</option>
	<option value="NE">Nebraska</option>
	<option value="NV">Nevada</option>
	<option value="NH">New Hampshire</option>
	<option value="NJ">New Jersey</option>
	<option value="NM">New Mexico</option>
	<option value="NY">New York</option>
	<option value="NC">North Carolina</option>
	<option value="ND">North Dakota</option>
	<option value="OH">Ohio</option>
	<option value="OK">Oklahoma</option>
	<option value="OR">Oregon</option>
	<option value="PA">Pennsylvania</option>
	<option value="RI">Rhode Island</option>
	<option value="SC">South Carolina</option>
	<option value="SD">South Dakota</option>
	<option value="TN">Tennessee</option>
	<option value="TX">Texas</option>
	<option value="UT">Utah</option>
	<option value="VT">Vermont</option>
	<option value="VA">Virginia</option>
	<option value="WA">Washington</option>
	<option value="WV">West Virginia</option>
	<option value="WI">Wisconsin</option>
	<option value="WY">Wyoming</option>

</select>		

<!--<input name="num_days" type="number" min="1" max="20" step="1" value={{num_days}} style="width:auto; margin:0 auto; margin-bottom:10px;display:inline;"></input> !-->

<select name="num_days" style="width:9%; margin:0 auto; margin-bottom:10px;display:inline;">	

	<option value="" selected>Date Range</option>

	{% if num_days=="1" %}
		<option value="1" selected>Today</option>
	{% else %}
		<option value="1">Today</option>
	{% endif %}

	{% if num_days=="7" %}
		<option value="7" selected>One Week</option>
	{% else %}
		<option value="7">One Week</option>
	{% endif %}

	{% if num_days=="30" %}
		<option value="30" selected>One Month</option>
	{% else %}
		<option value="30">One Month</option>
	{% endif %}

	{% if num_days=="365" %}
		<option value="365" selected>One Year</option>
	{% else %}
		<option value="365">One Year</option>
	{% endif %}

	{% if num_days=="" %}
		<option value="" selected>All Time</option>
	{% else %}
		<option value="">All Time</option>
	{% endif %}
	

</select>

<select name="sort_by" style="width:12%; margin:0 auto; margin-bottom:10px;">
	
	<option value = "">Sort By</option>

	{% if sort=="datetime_local.asc" or sort=="" %}
		<option value="datetime_local.asc" selected>Date Ascending</option>

	{% else %}

		<option value="datetime_local.asc">Date Ascending</option>

	{% endif %}

	{% if sort== "datetime_local.desc" %}
		<option value="datetime_local.desc" selected>Date Descending</option>

	{% else %}

		<option value="datetime_local.desc">Date Descending</option>

	{% endif %}

	{% if sort== "score.desc" %}
		<option value="score.desc" selected>Most Popular</option>

	{% else %}

		<option value="score.desc">Most Popular</option>

	{% endif %}

	{% if sort== "score.asc" %}
		<option value="score.asc" selected>Least Popular</option>

	{% else %}

		<option value="score.asc">Least Popular</option>

	{% endif %}
	
</select>	

<select name="per_page" style="width:8%; margin:0 auto; margin-bottom:10px;">

	<option value = "">Per Page</option>	
	{% if (per_page == "10") or (per_page=="") %}
		<option value="10" selected>10</option>
	{% else %}
		<option value="10">10</option>
	{% endif %}

	{% if per_page == "25" %}
		<option value="25" selected>25</option>
	{% else %}
		<option value="25">25</option>
	{% endif %}

	{% if per_page == "50" %}
		<option value="50" selected>50</option>
	{% else %}
		<option value="50">50</option>
	{% endif %}

	{% if per_page == "100" %}
		<option value="100" selected>100</option>
	{% else %}
		<option value="100">100</option>
	{% endif %}

</select>





<div style="display:inline;">
	<button class="postfix search-button" style="width:auto; height:38px;" type="submit">Submit</button>
</div>


{% block results %}

		
		{% if num_events > 0 %}
	
		
		
		{% for n in range(num_events)%}
		

		<div class="row" style="width:99.5%;">
		<div class="small-12 columns" >
		<ul class="results" style="border-style: solid; border-color: #00688B; border-width:2px; margin-top:20px; margin-bottom: 20px; padding-top: 10px;height: 270px; background-color: rgba(188,210,238, .9);">

				{% if api_data["events"][n]["performers"][0]["image"] %}
				<li style="padding-top: 15px;">
			
					<img src={{api_data["events"][n]["performers"][0]["image"]}} height=300 width=300>
				</li>

				{% else %}

				<li style="margin-right:50px;">
					<img src="http://www.coloradowindensemble.org/wp-content/uploads/2013/06/ticket-graphic-ticket4.png" height=300 width=250>

				</li>
				
				{% endif %}
		<ul>
			<li>
				
					
						<li>

							{% if api_data["events"][n]["title"]|length > 80 %}

								<h6 class="blue roberto">{{ api_data["events"][n]["title"] }}</h6>

							{% else %}
								<h5 class="blue roberto">{{ api_data["events"][n]["title"] }}</h5>

							{% endif %}


						</li>
						<li>
							<h5 class="blue roberto">
							
								{{date_list[n]}} {% if api_data["events"][n]["time_tbd"] %}Time TBA{% else %}{{time_list[n]}}{% endif %}
							
							</h5>

						</li>
						<li>
							
							<h5 class="blue roberto"> {{api_data["events"][n]["venue"]["name"]}} | {{api_data["events"][n]["venue"]["display_location"]}}</h5>

						</li>
						<ul class="results">
							
							{% if api_data["events"][n]["stats"]["listing_count"] %}

							<li class="results" style="padding-top: 0px;">
								
								<h6 class="blue roberto"> Number of Listings: {{api_data["events"][n]["stats"]["listing_count"]}}</h6>


							</li>

							<li class="results">
								
								<h6 class="blue roberto"> Average Price: ${{price_list[n][0]}}</h6>


							</li>

							<li class="results">
								
								<h6 class="blue roberto"> Price Range: ${{price_list[n][1]}} - ${{price_list[n][2]}}
								</h6>


							</li>

							{% else %}

							<li>
								<h6 style="color: #FF0000; padding-right: 300px; font-family: 'Roboto Condensed', sans-serif;"> Tickets currently unavailable</h6>
							</li>

							{% endif %}




						</ul>


				</li>

				<ul class="results">
				
				<li><a href="/favorite/{{api_data["events"][n]["id"]}}" class="button" style="background-color: #00688B; color:white;">Add to Favorites</a></li>

				<li><a href="{{api_data["events"][n]["url"]}}" class="button" style="background-color: #00688B; color:white;">View Tickets on SeatGeek</a></li>

				</ul>
			</ul>
		</ul>
		
		</div>
		</div>
		
		


		
		{% endfor %}
		
	
	


	{% else %}
		<h1 class="blue">There were no events found.</h1>
	{% endif %}
	


	

	{% endblock %}

	{{ pagination.links }}


{% endblock %}